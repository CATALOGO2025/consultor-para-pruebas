<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Generador de Descripciones HTML con IA</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: Calibri, sans-serif;
    }
    h1 {
      background-color: #00b5e2;
      color: white;
      padding: 20px;
      border-radius: 8px;
    }
    hr {
      margin: 40px 0;
      border: none;
      height: 2px;
      background-color: #ccc;
    }
    .formulario {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
    }
    .formulario label {
      display: block;
      margin-top: 10px;
    }
    .formulario input, .formulario select, .formulario button {
      margin-top: 5px;
      padding: 6px;
      width: 100%;
      box-sizing: border-box;
    }
    #preview {
      margin-top: 20px;
      padding: 20px;
      border: 2px solid #00b5e2;
      background: #f0faff;
      border-radius: 10px;
      font-size: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    #progresoContainer {
      display: none;
      margin: 20px 0;
    }
    #barraProgreso {
      width: 0%;
      height: 20px;
      background-color: #00b5e2;
      color: white;
      text-align: center;
      line-height: 20px;
    }
    #notificacion {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #00b5e2;
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      font-size: 14px;
      display: none;
      z-index: 9999;
    }
  </style>
</head>
<body>
  <h1>üèçÔ∏è Generador de Descripciones para eCommerce</h1>

  <hr>

  <div class="formulario">
    <h2>üßæ Ingreso individual de datos</h2>
    <label>Categor√≠a (obligatorio):</label>
    <select id="categoria">
      <option value="prenda">Vestuario / Calzado</option>
      <option value="producto">Decoraci√≥n / Electro-tecno</option>
    </select>
    <label>Nombre:</label>
    <input id="nombre">
    <label>Marca:</label>
    <input id="marca">
    <label>Material:</label>
    <input id="material">
    <label>Dise√±o:</label>
    <input id="diseno">
    <label>Dimensiones:</label>
    <input id="dimensiones">
    <label>Bullet 1:</label>
    <input id="bullet1">
    <label>Bullet 2:</label>
    <input id="bullet2">
    <label>Bullet 3:</label>
    <input id="bullet3">
    <label>SKU:</label>
    <input id="sku">
    <button onclick="generarIndividual()">Generar descripci√≥n</button>
    <button onclick="descargarExcel()">üíæ Descargar como Excel</button>
    <div id="preview">
      <strong>üîç Vista previa:</strong>
      <div id="descripcionGenerada">Esperando generaci√≥n...</div>
    </div>
  </div>

  <hr>

  <div class="formulario">
    <h2>üìÇ Carga masiva desde Excel</h2>
    <label>Selecciona tu archivo Excel:</label>
    <input type="file" id="fileInput">
    <button onclick="procesarArchivo()">Generar descripciones masivas</button>
    <button onclick="generarArchivoEjemplo()">üì• Descargar archivo de ejemplo</button>
    <div id="progresoContainer">
      <div id="barraProgreso">0%</div>
    </div>
  </div>

  <div id="notificacion"></div>

  <script>
    function mostrarNotificacion(mensaje) {
      const noti = document.getElementById("notificacion");
      noti.textContent = mensaje;
      noti.style.display = "block";
      setTimeout(() => {
        noti.style.display = "none";
      }, 3000);
    }

    function generarArchivoEjemplo() {
      const wb = XLSX.utils.book_new();
      const data = [["sku", "nombre", "marca", "material", "dise√±o", "dimensiones", "bullet1", "bullet2", "bullet3"],
                    ["123456", "Polera b√°sica", "Paris Basics", "Algod√≥n", "Casual", "M-L-XL", "C√≥moda", "Transpirable", "Verano"]];
      const ws = XLSX.utils.aoa_to_sheet(data);
      XLSX.utils.book_append_sheet(wb, ws, "Productos");
      XLSX.writeFile(wb, "ejemplo_productos.xlsx");
    }

    function generarIndividual() {
      const nombre = document.getElementById("nombre").value;
      const marca = document.getElementById("marca").value;
      const material = document.getElementById("material").value;
      const diseno = document.getElementById("diseno").value;
      const dimensiones = document.getElementById("dimensiones").value;
      const categoria = document.getElementById("categoria").value;
      const bullet1 = document.getElementById("bullet1").value.trim();
      const bullet2 = document.getElementById("bullet2").value.trim();
      const bullet3 = document.getElementById("bullet3").value.trim();

      const tipo = categoria === "prenda" ? "una prenda" : "un producto";
      const tipoN = categoria === "prenda" ? "la prenda" : "el producto";
      const tipoM = categoria === "prenda" ? "nuestra prenda" : "nuestro producto";

      let h3 = `<h3>${nombre}`;
      if (marca) h3 += ` ${marca}`;
      if (material) h3 += ` de ${material}`;
      h3 += `</h3>`;

      let cuerpo = `<p>`;
      cuerpo += `Descubre la versatilidad de ${tipoM} ${nombre.toLowerCase()}.`;
      if (diseno) cuerpo += ` Su dise√±o ${diseno.toLowerCase()} la convierte en ${tipo} ideal para cualquier ocasi√≥n.`;
      if (dimensiones) cuerpo += ` Disponible en tallas ${dimensiones}.`;
      cuerpo += ` ¬°Agrega ${tipoN} al carro y disfruta de su estilo √∫nico!`;
      cuerpo += `</p>`;

      if (bullet1 || bullet2 || bullet3) {
        cuerpo += `<ul>`;
        if (bullet1) cuerpo += `<li>${bullet1}</li>`;
        if (bullet2) cuerpo += `<li>${bullet2}</li>`;
        if (bullet3) cuerpo += `<li>${bullet3}</li>`;
        cuerpo += `</ul>`;
      }

      document.getElementById("descripcionGenerada").innerHTML = h3 + cuerpo;
    }

    function descargarExcel() {
      const sku = document.getElementById("sku").value || "SKU-sin-definir";
      const contenido = document.getElementById("descripcionGenerada").innerHTML;
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.aoa_to_sheet([["SKU", "Descripci√≥n Larga"], [sku, contenido]]);
      XLSX.utils.book_append_sheet(wb, ws, "Descripciones");
      XLSX.writeFile(wb, "descripcion_larga.xlsx");
    }
  </script>
</body>
</html>
