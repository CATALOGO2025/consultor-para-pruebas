<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>📦 Creador de Descripciones Largas</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
<script>

// --- Helpers robustos para URL de Marca (idempotente) ---
if (typeof cleanCell !== 'function') {
  function cleanCell(v){
    return String(v||'').replace(/\u00A0/g,' ').replace(/[“”"']/g,'').trim();
  }
}
if (typeof buildMarcaUrl !== 'function') {
  function buildMarcaUrl(v) {
  if (!v) return "";
  const t = String(v).trim();
  if (/^https?:\/\//i.test(t)) return t; // URL completa
  const fileOnly = t.replace(/^.*[\\/]/, "").replace(/[?#].*$/, "");
  // Defaults si no existen las constantes globales
  const part1 = (typeof MARCA_IMG_PART1 !== 'undefined') ? MARCA_IMG_PART1 : 'https://www.paris.cl/images/Contenido%20Fichas/Logos/';
  const part2 = (typeof MARCA_IMG_PART2 !== 'undefined') ? MARCA_IMG_PART2 : '?$staticlink$';
  return part1 + encodeURIComponent(fileOnly) + part2;
}
}


// --- Prefijo/sufijo para Imágenes Diferenciadoras ---
const DIF_IMG_PART1 = "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/";
const DIF_IMG_PART2 = "?$staticlink$";
function buildDifUrl(v) {
  if (!v) return "";
  const trimmed = String(v).trim();
  if (/^https?:\/\//i.test(trimmed)) return trimmed;
  const fileOnly = trimmed.replace(/^.*[\/]/, "").replace(/[?#].*$/, "");
  const ext = (fileOnly.split(".").pop() || "").toLowerCase();
  const allowed = ["webp","jpg","jpeg"]; // acepta .webp y .jpg (.jpeg)
  if (!allowed.includes(ext)) console.warn("Extensión no habitual en Imagen diferenciadora:", ext);
  return DIF_IMG_PART1 + encodeURIComponent(fileOnly) + DIF_IMG_PART2;
}


function flashDownloadOk() {
  try {
    var btn = document.getElementById('btnDescargarPlantilla');
    if (!btn) return;
    // Preserve width to avoid layout shift
    var w = btn.offsetWidth;
    btn.style.minWidth = w + 'px';
    var oldHTML = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '✓ Descargado';
    setTimeout(function(){
      btn.innerHTML = oldHTML;
      btn.disabled = false;
      btn.style.minWidth = '';
    }, 1800);
  } catch(e) { /* silent */ }
}



// === URL remota OVERRIDE (opcional). Si está definida y accesible, se usa primero.
const PLANTILLA_REMOTE_URL = "";



// === Plantilla Excel embebida (base64) ===
const PLANTILLA_XLSX_FILENAME = "Plantilla_Descripciones.xlsx";
// === Iconos de diferenciadores ===
const ICONO_URLS = {
  "Cruelty Free": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-crueltyfree.png?$staticlink$",
  "Libre de Pesticidas": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-libre-pesticidas.png?$staticlink$",
  "No Probado en Animales": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-no-probado-animales.png?$staticlink$",
  "No Toxico": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-no-toxico.png?$staticlink$",
  "Probado Lab": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-probado-lab.png?$staticlink$",
  "Sin Aceite": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-aceite.png?$staticlink$",
  "Sin Parabenos": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-parabenos.png?$staticlink$",
  "Sin Sulfatos": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-sulfatos.png?$staticlink$",
  "Vegano": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-vegano.png?$staticlink$"
};
const ICONO_OPTIONS = Object.keys(ICONO_URLS);

function pickIconValues(row) {
  const raw = [
    (row["Icono 1"] || "").trim(),
    (row["Icono 2"] || "").trim(),
    (row["Icono 3"] || "").trim(),
    (row["Icono 4"] || "").trim(),
    (row["Icono 5"] || "").trim(),
    (row["Icono 6"] || "").trim()
  ].filter(Boolean);
  const unique = raw.filter((v, i) => raw.indexOf(v) === i);
  return unique.filter(v => ICONO_OPTIONS.includes(v));
}

function renderIconosVisual(iconosArr) {
  if (!iconosArr || !iconosArr.length) return "";
  const imgs = iconosArr.map(label => {
    const src = ICONO_URLS[label];
    const alt = label;
    return `<img src="${src}" alt="${alt}" title="${alt}">`;
  }).join("");
  return `<div class="iconos-wrap">${imgs}</div>`;
}


function renderIconosExport(iconosArr) {
  if (!iconosArr || !iconosArr.length) return "";
  const imgs = iconosArr.map(label => {
    const src = ICONO_URLS[label];
    const alt = label;
    return `<img src="${src}" alt="${alt}" title="${alt}" style="width:72px;height:72px;border-radius:50%;object-fit:contain;display:inline-block;margin-right:12px;">`;
  }).join("");
  const divider = `<div style="height:1px;background:#e5e7eb;margin:10px 0;"></div>`;
  return `${divider}<div style="display:flex;flex-wrap:wrap;align-items:center;margin:6px 0 14px 20px;">${imgs}</div>${divider}`;
}

const PLANTILLA_XLSX_B64 = "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";






async function downloadTemplate() {
  const statusEl = document.getElementById('tplStatus');
  if (statusEl) { statusEl.style.display = 'none'; statusEl.textContent = ''; }

  const filename = (typeof PLANTILLA_XLSX_FILENAME === 'string' && PLANTILLA_XLSX_FILENAME) ? PLANTILLA_XLSX_FILENAME : "Plantilla_Descripciones.xlsx";

  async function tryFetch(url) {
    try {
      const r = await fetch(url, { cache: "no-store" });
      if (!r.ok) throw new Error("HTTP " + r.status);
      const b = await r.blob();
      const u = URL.createObjectURL(b);
      const a = Object.assign(document.createElement('a'), { href: u, download: filename });
      document.body.appendChild(a); a.click(); URL.revokeObjectURL(u); a.remove();
      // Success UI feedback
      flashDownloadOk();
      return true;
    } catch (e) {
      console.warn("Descarga remota fallida:", url, e && e.message ? e.message : e);
      return false;
    }
  }

  // Orden de intento: Override → Absoluta → Relativa → Fallback embebido
  if (typeof PLANTILLA_REMOTE_URL === "string" && PLANTILLA_REMOTE_URL) {
    const ok0 = await tryFetch(PLANTILLA_REMOTE_URL);
    if (ok0) return;
  }

  const absUrl = "https://catalogo2025.github.io/consultor-para-pruebas/assets/" + filename + "?v=" + Date.now();
  if (await tryFetch(absUrl)) return;

  const relUrl = new URL("assets/" + filename + "?v=" + Date.now(), window.location.href).href;
  if (await tryFetch(relUrl)) return;

  // Fallback embebido
  try {
    if (typeof PLANTILLA_XLSX_B64 === "string" && PLANTILLA_XLSX_B64.length > 0) {
      const byteChars = atob(PLANTILLA_XLSX_B64);
      const byteNumbers = new Array(byteChars.length);
      for (let i = 0; i < byteChars.length; i++) byteNumbers[i] = byteChars.charCodeAt(i);
      const blob = new Blob([new Uint8Array(byteNumbers)], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
      const url = URL.createObjectURL(blob);
      const a = Object.assign(document.createElement('a'), { href: url, download: filename });
      document.body.appendChild(a); a.click(); URL.revokeObjectURL(url); a.remove();
      flashDownloadOk();
      return;
    }
  } catch (e) {
    console.error("Fallback embebido falló:", e);
  }

  alert("No se pudo descargar la plantilla. Verifica que exista en /assets o que el fallback esté embebido.");
}








window.onerror=function(m,s,l,c,e){alert('⚠️ Error JS '+m+' ['+l+':'+c+']');};


function cleanForCSV(html) {
  if (html == null) return '';
  // Reemplazar comillas dobles por entidad HTML para no romper CSV con ';' como separador
  return String(html).replace(/"/g, '&quot;');
}

function formatDescripcionHTML(textoPlano) {
    if (!textoPlano) return '';
    let t = String(textoPlano).replace(/\r\n/g, '\n').replace(/\r/g, '\n');
    // Mantener regla existente: forzar '##' a nueva línea si viene pegado
    t = t.replace(/([^\n])##/g, '$1\n##');
    // Negritas con *...*
    t = t.replace(/\*(.*?)\*/g, '<b>$1</b>');

    const lines = t.split('\n');
    let out = [];
    for (let i = 0; i < lines.length; ) {
        let line = lines[i];

        // Encabezado "## Título" -> <br><h4><b>Título</b></h4> (con salto ANTES y sin salto después)
        const h = line.match(/^##\s*(.+)/);
        if (h) {
            const hdr = '<h4 style="margin:6px 0 0 0;"><b>' + h[1].trim() + '</b></h4>';
            if (out.length > 0) {
                out.push('<br class="pre-h4">' + hdr);
            } else {
                out.push(hdr);
            }
            i++;
            continue;
        }

        // Lista con guion al inicio "- item"
        if (/^\s*-\s+/.test(line)) {
            let items = [];
            while (i < lines.length && /^\s*-\s+(.+)$/.test(lines[i])) {
                items.push(lines[i].replace(/^\s*-\s+/, '').trim());
                i++;
            }
            out.push("<ul style='list-style:none;margin:0;padding-left:0;'>" + items.map(li => "<li style='margin:0;line-height:1.6;'>- " + li + "</li>").join("") + "</ul>");
            continue;
        }

        // Lista separada por punto y coma "a; b; c"
        if (line.includes(';')) {
            const items = line.split(';').map(s => s.trim()).filter(Boolean);
            if (items.length >= 2) {
                out.push("<ul style='list-style:none;margin:0;padding-left:0;'>" + items.map(li => "<li style='margin:0;line-height:1.6;'>- " + li + "</li>").join("") + "</ul>");
                i++;
                continue;
            }
        }

        // Línea normal
        if (line.length > 0) out.push(line);
        i++;
    }

    let html = out.join('<br>');
    // Evitar salto inmediato después del h4
    html = html.replace(/<\/h4><br>/g, '</h4>');
    html = html.replace(/(<br>\s*)+(<br class="pre-h4">)/g, '$2');
    html = html.replace(/^\s*(<br class="pre-h4">)+/m, '<br class="pre-h4">');
    html = html.replace(/(<br class="pre-h4">)\s*<br>/g, '$1');
    html = html.replace(/(<br>){2,}/g, '<br>');
    html = html.replace(/<\/h4><br>/g, '</h4>');
    html = html.replace(/(<br>\s*)+(<br class="pre-h4">)/g, '$2');
    html = html.replace(/^\s*(<br class="pre-h4">)+/m, '<br class="pre-h4">');
    html = html.replace(/(<br class="pre-h4">)\s*<br>/g, '$1');
    html = html.replace(/(<br>\s*)+(<br class="pre-h4">)/g, '$2');
    html = html.replace(/^\s*(<br class="pre-h4">)+/m, '<br class="pre-h4">');
    html = html.replace(/(<br>){2,}/g, '<br>');
    return html;
}
function formatMetaDescripcion(texto) {
    if (!texto) return '';
    const style = "margin-bottom:18px; background:#f4f6f7; color:#333; font-size:15px; padding:12px 20px; border-radius:8px; font-weight:normal; line-height:1.6;";
    const bloques = String(texto).trim().split(/\r?\n\r?\n/);
    return bloques.map(b => `<p style='${style}'>${b.replace(/\r?\n/g, '<br>')}</p>`).join('');
}
function cleanYoutubeUrl(url) {
    if (!url) return '';
    let cleanUrl = url.trim();
    if (cleanUrl.includes('youtu.be/')) {
        cleanUrl = cleanUrl.split('?')[0];
        const videoId = cleanUrl.split('youtu.be/')[1];
        return `https://www.youtube.com/embed/${videoId}`;
    }
    if (cleanUrl.includes('watch?v=')) {
        cleanUrl = cleanUrl.replace('watch?v=', 'embed/').split('&')[0];
        return cleanUrl.split('?')[0];
    }
    

return cleanUrl.split('?')[0];
}

// --- Helper: elimina la caja de ficha técnica si la tabla quedó vacía (sin filas) ---
function removeEmptyFichaBlocks(s) {
  try {
    return s.replace(/<div[^>]*>\s*<h3[^>]*>[^<]*Nuestros Productos[^<]*<br>Ficha técnica y especificaciones<\/h3>\s*<table[^>]*>\s*<\/table>\s*<\/div>/gis, '');
  } catch (e) { return s; }
}
</script>
<style>
body { font-family: Calibri, sans-serif; margin: 0; background-color: #f4f6f7; font-size: 14px; }
.header { flex-direction:row; gap:12px; justify-content:center; align-items:center; display:flex;  color: white; padding: 20px; font-size: 28px; text-align: center; font-weight: bold;  background:#000273; }
.card { margin: 20px; background: linear-gradient(180deg, #ffffff, #f8f9fa); border-radius:8px; padding: 20px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); border: 1px solid #ddd; }
h2 { border-bottom: 1px solid #ddd; padding-bottom: 10px; font-size: 20px; }
button { background: linear-gradient(#1f618d, #154360); color: white; border: none; padding: 12px 20px; margin-right: 10px; margin-bottom: 10px; border-radius:8px; cursor: pointer; font-size: 14px; box-shadow: 0 3px 6px rgba(0,0,0,0.1); transition: all 0.2s ease-in-out; }
button:hover { transform: scale(1.02); box-shadow: 0 5px 12px rgba(0,0,0,0.15); }
.visual-id { margin-bottom: 5px; background: #d6eaf8 !important; color: #21618c !important; font-size: 14px !important; padding: 6px 12px !important; border-radius:8px !important; font-weight: bold !important; display: inline-block !important; }
img[alt="Marca"] { max-width: 100px !important; height: auto !important; display: block; margin: 0 auto; }
img[alt="Descripción"], img[alt="Material"], img[alt="Dimensiones"] { width: 50px !important; height: 50px !important; object-fit: contain !important; display: block; margin: 0 auto; }
img[src=""] { display: none; }
table td { max-width: 140px; overflow: hidden; vertical-align: middle; text-align: left; }
@media (max-width: 600px) {
  table { width: 100% !important; margin: 0 !important; padding: 0 !important; }
  table tr { display: flex; flex-direction: column; width: 100%; margin: 0; border-bottom: 1px solid #ccc; }
  table td { width: 100% !important; text-align: center !important; padding: 10px 5px; box-sizing: border-box; }
  img[alt="Marca"] { max-width: 100px !important; height: auto !important; display: block; margin: 0 auto; }
  img[alt="Descripción"], img[alt="Material"], img[alt="Dimensiones"] { width: 50px !important; height: 50px !important; object-fit: contain !important; display: block; margin: 0 auto; }
}
.easy-ficha-wrapper * { all: revert; box-sizing: border-box; }
.video-container { width: 100% !important; display: block; margin: 0 auto;   }
.video-container iframe { width: 100% !important;   display: block; }
br.pre-h4{display:block;margin:0 0 0 0;}
.ul-text{list-style:none;margin:0;padding-left:0;}
.ul-text li{margin:0;line-height:1.6;}
.ul-text li::before{content:"- ";}

/* === Iconos de diferenciadores (bajo descripción larga) === */
.iconos-wrap {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
  margin: 6px 0 14px 0; /* alineado con padding-left de la descripción (20px) */
}
.iconos-wrap img {
  width: 60px;
  height: 60px;
  object-fit: contain;
  display: inline-block;
}

/* ensure space under the specs block so it never hugs the video */
.easy-ficha-wrapper .specs-table, 
.easy-ficha-wrapper .specs, 
.easy-ficha-wrapper .tabla, 
.easy-ficha-wrapper .table-wrap {
  padding-bottom: 8px;
}

/* --- Visual-only divider between cards (preview only) --- */
.card-divider{
  height: 1px;
  background: #e9eef3;
  border: 0;
  margin: clamp(18px, 2.5vw, 26px) 0;
  width: 100%;
}


/* --- Divider between rows (visualization only) --- */
.row-divider{
  flex-basis: 100%;
  height: 1px;
  background: #e9eef3;
  margin: clamp(18px, 2.5vw, 26px) 0;
  border: 0;
}

</style>
<style>

/* ==== Responsividad Web / Mobile / App ==== */
@media (max-width: 900px) {
  .header { font-size: 18px;  background:#000273; }
  .card { padding: 14px !important; }
  .easy-ficha-wrapper { display: block !important; }
  /* Botón de descarga: que ocupe ancho completo en mobile */
  a[style*="background-color:#0057cb"] {
    display: block !important;
    width: 100% !important;
    text-align: center !important;
  }
  /* Tabla responsive: columnas apiladas */
  .card table { width: 100% !important; border-collapse: collapse; }
  .card table tr { display: block; border-bottom: 1px solid #eee; }
  .card table td { display: block; width: 100% !important; padding: 10px 12px !important; }
  /* Íconos más pequeños en mobile */
  .card img[alt="Material"],
  .card img[alt="Dimensiones"] { width: 40px !important; height: 40px !important; }
}
/* Imágenes fluidas */
img { max-width: 100%; height: auto; }
/* Video responsive con proporción 16:9 */
.video-container { position: relative; width: 100%; padding-top: 56.25%; }
.video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
/* Listas renderizadas desde guiones: margen agradable */
.ul-text { padding-left: 18px; margin: 6px 0; }

</style>

<style>

/* === Unified responsive video (16:9) with rounded corners === */
.video-container{
  position: relative;
  width: 100%;
  padding-top: 56.25% !important; /* override any previous padding */
  margin-top: clamp(24px, 3.5vw, 40px) !important;
  border-radius:8px;
  overflow: hidden;
}
.video-container iframe{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100% !important; /* override any previous height */
  border: 0;
  display: block;
  border-radius: inherit;
}

</style>
</head>
<body>
<div class="header" style="background:#000273;"><img src="https://cl-paris-media-hub.ecomm.cencosud.com/files/logos_paris/logos_web/Header_Brand_125_60x60.svg?v=1" alt="Paris" style="max-height:40px;height:auto;width:auto;display:block;"/><span>Creador de Descripciones Largas</span></div>
<div class="card">
<h2>📜 Instrucciones</h2>
<ul style="line-height:1.7;">
<li>👨‍💻 <b>Descargar Plantilla:</b> Usa el botón para descargar un Excel preformateado.</li>
<li>📁 <b>Procesar Excel:</b> Completa los campos requeridos.</li>
<li>👁️ <b>Previsualizar:</b> Visualizar Tablas muestra resultados.</li>
<li>⬇️ <b>Exportar:</b> Exportar HTML a Excel descarga resultados.</li>
</ul>
<div style="background: #fff9e6; border-left: 6px solid #f5c518; border-top-left-radius: 12px; border-bottom-left-radius: 12px; padding: 20px; margin-bottom: 30px;">
  <h3 style="margin-top: 0; color: #7d6608;">📌 <b>Directrices</b></h3>
  <ul style="line-height:1.7; color: #000; margin: 0;"><li><b>Descripción corta:</b> Máximo 160 caracteres.</li>
<li><b>Descripción larga:</b> Este campo se convierte en texto HTML. Usa palabras *entre asteriscos* para poner en negrita, y ## antes de títulos para destacarlos.</li>
<li><b>Descripción de la Marca:</b> Usa el archivo "Descripciones Marcas y urls" desde SharePoint.</li>
<li><b>Imagen de Marca:</b> Agrega el nombre de la imagen más la extensión, Ej. logoBC.png (acepta .jpg, .jpeg, .png, .webp ✅). Debe estar alojada en Filezilla &gt; Carpeta Logos (Máx 60 px de alto)</li>
<li><b>Video YouTube:</b> Se acepta tanto la URL corta como la larga para incrustar videos.</li>
<li><b>Descarga de documentos:</b> Selecciona en el Excel el botón que se acomode a tu necesidad más la URL del archivo.</li>
<li>En la plantilla descargada podrás ver las instrucciones en mayor detalle</li></ul>
</div>
<button onclick="updateTables()">👁️ Visualizar Tablas</button>
<button onclick="exportHtmlToExcel()">⬇️ Exportar HTML a Excel</button>
<button id="btnDescargarPlantilla" onclick="downloadTemplate()">📄 Descargar Plantilla</button> <span id="tplStatus" style="font-size:12px;color:#555;margin-left:8px;display:none;"></span>
<button onclick="limpiarTodo()">🧹 Limpiar Todo</button>
<input accept=".xlsx" id="importFile" onchange="importExcel()" type="file"/>
</div>
<div class="card" id="tablesContainer"></div>
<script>

const defaultImagenes = {
  descripcion: "https://cl-gm-original-files.ecomm.cencosud.com/is/image/EasySA/logo_producto.png",
  material:     "https://cl-gm-original-files.ecomm.cencosud.com/is/image/EasySA/logo_material.png",
  dimensiones:  "https://cl-gm-original-files.ecomm.cencosud.com/is/image/EasySA/logo_dimensiones.png"
};

let excelRows = [];

function importExcel() {
  const file = document.getElementById('importFile').files[0];
  if (!file) return alert('Por favor selecciona un archivo Excel.');
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, {type: 'array'});
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    excelRows = XLSX.utils.sheet_to_json(sheet, { defval: "", raw: false });
    if (!excelRows.length) return alert('❌ No se encontraron filas en el Excel.');
    alert('📁 Excel cargado correctamente. Puedes visualizar las tablas.');
  };
  reader.readAsArrayBuffer(file);
}
// Helper para obtener campo por nombre de cabecera, tolerante a variantes
function get(row, keys) {
  for (const k of keys) {
    if (k in row && row[k] !== undefined && row[k] !== null) return String(row[k]);
  }
  return "";
}
function updateTables() {
  const container = document.getElementById('tablesContainer');
  if (!excelRows.length) {
    container.innerHTML = '<p>❌ No hay datos cargados. Por favor sube un Excel primero.</p>';
    return;
  }
  let html = '<div class="easy-ficha-wrapper" style="display:flex; flex-wrap:wrap; gap:20px;">';
  excelRows.forEach((row, index) => {
    const sku = get(row, ['SKU']);
    const marca = get(row, ['Descripción de la Marca','Descripcion de la Marca','Descripción Marca']);
    const descripcion = get(row, ['Nombre del Producto','Nombre Producto','Producto']);
    const material = get(row, ['Material']);
    const dimensiones = get(row, ['Dimensiones']);
    console.log('Marca URL (build):', buildMarcaUrl);
    const _rawMarca = cleanCell(get(row, ['URL Imagen Marca','Url Imagen Marca','Imagen de Marca','imagen de marca']));
const imgMarca = buildMarcaUrl(_rawMarca);
    const imgDesc = get(row, ['URL Imagen Descripción','URL Imagen Descripcion']);
    const imgMaterial = get(row, ['URL Imagen Material']);
    const imgDimensiones = get(row, ['URL Imagen Dimensiones']);
    const descripcionProducto = get(row, ['Descripción larga','Descripcion larga','Descripción Larga','Descripcion Larga','Descripción']);
    const videoUrl = get(row, ['VideoYouTube','Video YouTube','YouTube']);
    const metaDescripcion = get(row, ['Meta Descripción','Meta Descripcion','Descripción corta','Descripcion corta']);
    const botonTexto = get(row, ['Archivo Descargable (Botón)','Archivo Descargable (Boton)','Texto Botón','Texto Boton']);
    const botonUrl = get(row, ['URL archivo descargable','URL Archivo Descargable','URL botón','URL Boton','Manual de uso URL']);
    
    const iconos = pickIconValues(row);
const cta = metaDescripcion.trim(); // sin fallback
    const embedUrl = cleanYoutubeUrl(videoUrl);
    let botonHTML = '';
    
    // --- Imágenes diferenciadoras (Excel: Imagen diferenciadora 1/2/3) ---
    const dif1Name = get(row, ['Imagen diferenciadora 1','Imagen diferenciadora 1 ']);
    const dif2Name = get(row, ['Imagen diferenciadora 2','Imagen diferenciadora 2 ']);
    const dif3Name = get(row, ['Imagen diferenciadora 3','Imagen diferenciadora 3 ']);

    const dif1 = buildDifUrl(dif1Name);
    const dif2 = buildDifUrl(dif2Name);
    const dif3 = buildDifUrl(dif3Name);

    // Bloque 1: debajo de la descripción corta
    let difBlock1 = '';
    if (dif1) {
      difBlock1 = `
        <div style="margin:16px 0; clear:both;">
          <img src="${dif1}" alt="" loading="lazy" decoding="async"
               style="width:100%;height:auto;display:block;border-radius:10px;">
        </div>`;
    }

    // Bloque 2-3: debajo del botón (dos columnas)
        // Bloque 2-3: debajo del botón (dos columnas)
    let difBlock23 = '';
    if (dif2 || dif3) {
      difBlock23 = `
        <div style="margin:10px 0 0 0; display:grid; grid-template-columns:repeat(auto-fit, minmax(240px, 1fr)); gap:12px; align-items:start; width:100%; clear:both;">
          ${dif2 ? `<img src="${dif2}" alt="" loading="lazy" decoding="async" style="width:100%;height:auto;display:block;border-radius:10px;object-fit:contain;">` : ''}
          ${dif3 ? `<img src="${dif3}" alt="" loading="lazy" decoding="async" style="width:100%;height:auto;display:block;border-radius:10px;object-fit:contain;">` : ''}
        </div>`;
    }
    
    
    if (botonTexto && botonUrl) {
      botonHTML = `
                <div style='margin: 15px 0;'>
          <a href='${botonUrl}' target='_blank' style='
            display:inline-block; background-color:#0057cb; color:#fff;
            padding:12px 20px; border-radius:6px; font-weight:bold; text-decoration:none;
            box-shadow:0 3px 6px rgba(0,0,0,0.1); transition:all 0.2s ease-in-out;
          ' onmouseover="this.style.boxShadow='0 5px 12px rgba(0,0,0,0.2)'"
             onmouseout="this.style.boxShadow='0 3px 6px rgba(0,0,0,0.1)'">
            ${botonTexto}
          </a>
        </div>`;
    }
    html += `<div style='flex:1 1 400px; margin-bottom:25px; background:#fff; padding: clamp(14px, 2vw, 22px); border:1px solid #eef2f6; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.08); overflow:hidden;'>
<div class='visual-id'>Ficha N° ${index + 1}</div>
<div style='display:inline-block; background:#f4f6f7; color:#333; font-size:13px; padding:4px 10px; border-radius:8px; margin-top:6px;'>📦 SKU: ${sku}</div>
<h3 style='margin-bottom:15px; color:#2c3e50;'>${descripcion}</h3>
${cta ? formatMetaDescripcion(cta) : ''}
${imgMarca ? `<div style='margin:6px 0 8px 0;'><img src='${imgMarca}' alt='Imagen de Marca' style='max-height:50px;height:auto;width:auto;display:block;'></div>` : ''}
${marca ? `<div style='margin-bottom:10px; font-size:15px;'>${marca}</div>` : ''}${difBlock1}
${descripcionProducto ? `<div style='margin-bottom:15px; background:transparent; color:#000; font-size:15px; padding:12px 0; border-radius:8px;'>${formatDescripcionHTML(descripcionProducto)}</div>` : ''}
${renderIconosExport(iconos)}
${botonHTML}${difBlock23}
<div style='border:1px solid #ddd; border-radius:8px; background:#fff;'>
<h3 style='background: #2C3E50;color:white;padding:15px;margin:0; text-align:center; border-radius:8px 8px 0 0;'>Nuestros Productos<br>Ficha técnica y especificaciones</h3>
<table style='width:100%; border-collapse:collapse;'>`;
    if (material) html += `<tr style='border-bottom:1px solid #ddd;'><td style='padding:15px;'><img src='${imgMaterial || defaultImagenes.material}' alt='Material'></td><td style='padding:15px;'><b>Material:</b> ${material}</td></tr>`;
    if (dimensiones && dimensiones.trim() !== '') html += `<tr><td style='padding:15px;'><img src='${imgDimensiones || defaultImagenes.dimensiones}' alt='Dimensiones'></td><td style='padding:15px;'><b>Dimensiones:</b> ${dimensiones}</td></tr>`;
    html += `</table></div>`;
    if (embedUrl) html += `<div style='position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:8px;max-width:100%'><iframe style='position:absolute;top:0;left:0;width:100%;height:100%;border:0' loading='lazy' referrerpolicy='strict-origin-when-cross-origin' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share' height='auto' src='${embedUrl}' frameborder='0' allowfullscreen></iframe></div>`;
    html += `</div>`;
  
    /* divider after each row of 3 cards (visual only) */
    if (((index + 1) % 3) === 0 && index < excelRows.length - 1) {
      html += `<div class="row-divider"></div>`;
    }
});
  html += '</div>';
  container.innerHTML = removeEmptyFichaBlocks(html);
}
function exportHtmlToExcel() {
  if (!excelRows.length) return alert('❌ No hay datos cargados para exportar.');
  const data = [['SKU', 'Descripción Larga/Emocional']];
  excelRows.forEach((row) => {
    const sku = get(row, ['SKU']);
    const marca = get(row, ['Descripción de la Marca','Descripcion de la Marca','Descripción Marca']);
    const descripcion = get(row, ['Nombre del Producto','Nombre Producto','Producto']);
    const material = get(row, ['Material']);
    const dimensiones = get(row, ['Dimensiones']);
    const imgMarca = get(row, ['URL Imagen Marca','URL Imagen Marca ']);
    const imgDesc = get(row, ['URL Imagen Descripción','URL Imagen Descripcion']);
    const imgMaterial = get(row, ['URL Imagen Material']);
    const imgDimensiones = get(row, ['URL Imagen Dimensiones']);
    const descripcionProducto = get(row, ['Descripción larga','Descripcion larga','Descripción Larga','Descripcion Larga','Descripción']);
    const videoUrl = get(row, ['VideoYouTube','Video YouTube','YouTube']);
    const metaDescripcion = get(row, ['Meta Descripción','Meta Descripcion','Descripción corta','Descripcion corta']);
    const botonTexto = get(row, ['Archivo Descargable (Botón)','Archivo Descargable (Boton)','Texto Botón','Texto Boton']);
    const botonUrl = get(row, ['URL archivo descargable','URL Archivo Descargable','URL botón','URL Boton','Manual de uso URL']);
    
    const iconos = pickIconValues(row);
const cta = metaDescripcion.trim(); // sin fallback
    const embedUrl = cleanYoutubeUrl(videoUrl);
    let botonHTML = '';
    // --- Imágenes diferenciadoras (Excel: Imagen diferenciadora 1/2/3) ---
    const dif1Name = get(row, ['Imagen diferenciadora 1','Imagen diferenciadora 1 ']);
    const dif2Name = get(row, ['Imagen diferenciadora 2','Imagen diferenciadora 2 ']);
    const dif3Name = get(row, ['Imagen diferenciadora 3','Imagen diferenciadora 3 ']);

    const dif1 = buildDifUrl(dif1Name);
    const dif2 = buildDifUrl(dif2Name);
    const dif3 = buildDifUrl(dif3Name);
    console.log('DIF URLs:', dif1, dif2, dif3);

    let difBlock1 = '';
if (dif1) {
  difBlock1 = `
    <div style="margin:16px 0; clear:both;">
      <img src="${dif1}" alt="" loading="lazy" decoding="async"
           style="width:100%;height:auto;display:block;border-radius:10px;">
    </div>`;
}

let difBlock23 = '';
if (dif2 || dif3) {
  difBlock23 = `
    <div style="margin:10px 0 0 0; display:grid; grid-template-columns:repeat(auto-fit, minmax(240px, 1fr)); gap:12px; align-items:start; width:100%; clear:both;">
      ${dif2 ? `<img src="${dif2}" alt="" loading="lazy" decoding="async" style="width:100%;height:auto;display:block;border-radius:10px;object-fit:contain;">` : ''}
      ${dif3 ? `<img src="${dif3}" alt="" loading="lazy" decoding="async" style="width:100%;height:auto;display:block;border-radius:10px;object-fit:contain;">` : ''}
    </div>`;
}

    
    if (botonTexto && botonUrl) {
      botonHTML = `
                <div style='margin: 15px 0;'>
          <a href='${botonUrl}' target='_blank' style='
            display:inline-block; background-color:#0057cb; color:#fff;
            padding:12px 20px; border-radius:6px; font-weight:bold; text-decoration:none;
            box-shadow:0 3px 6px rgba(0,0,0,0.1); transition:all 0.2s ease-in-out;
          ' onmouseover="this.style.boxShadow='0 5px 12px rgba(0,0,0,0.2)'"
             onmouseout="this.style.boxShadow='0 3px 6px rgba(0,0,0,0.1)'">
            ${botonTexto}
          </a>
        </div>`;
    }
    let html = `<div style='margin-bottom:25px; background:#fff;'>
<h3 style='margin-bottom:15px; color:#2c3e50;'>${descripcion}</h3>
${cta ? formatMetaDescripcion(cta) : ''}
${imgMarca ? `<div style='margin:6px 0 8px 0;'><img src='${imgMarca}' alt='Imagen de Marca' style='max-height:50px;height:auto;width:auto;display:block;'></div>` : ''}
${marca ? `<div style='margin-bottom:10px; font-size:15px;'>${marca}</div>` : ''}${difBlock1}
${descripcionProducto ? `<div style='margin-bottom:15px; background:transparent; color:#000; font-size:15px; padding:12px 0; border-radius:8px;'>${formatDescripcionHTML(descripcionProducto)}</div>` : ''}
${renderIconosExport(iconos)}
${botonHTML}
<div style='border:1px solid #ddd; border-radius:8px;'>
<h3 style='background: #2C3E50;color:white;padding:15px;margin:0; text-align:center;'>Nuestros Productos<br>Ficha técnica y especificaciones</h3>
<table style='width:100%; border-collapse:collapse;'>`;
    if (material) html += `<tr style='border-bottom:1px solid #ddd;'><td style='padding:15px;'><img src='${imgMaterial || defaultImagenes.material}'></td><td style='padding:15px;'><b>Material:</b> ${material}</td></tr>`;
    if (dimensiones) html += `<tr><td style='padding:15px;'><img src='${imgDimensiones || defaultImagenes.dimensiones}'></td><td style='padding:15px;'><b>Dimensiones:</b> ${dimensiones}</td></tr>`;
    html += `</table></div>`;
    if (embedUrl) html += `<div style='position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:8px;max-width:100%'><iframe style='position:absolute;top:0;left:0;width:100%;height:100%;border:0' loading='lazy' referrerpolicy='strict-origin-when-cross-origin' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share' height='auto' src='${embedUrl}' frameborder='0' allowfullscreen></iframe></div>`;
    html += `</div>`;
    html = removeEmptyFichaBlocks(html);
    data.push([sku, cleanForCSV(html)]);
  });
  const ws = XLSX.utils.aoa_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Descripciones');
  XLSX.writeFile(wb, 'descripciones_largas_formato_html.xlsx');
}
function limpiarTodo() {
  document.getElementById('importFile').value = '';
  document.getElementById('tablesContainer').innerHTML = '<p>📂 Sin datos cargados.</p>';
  excelRows = [];
  alert('🧹 Se limpiaron los datos y las tablas correctamente.');
}
</script>
</body>
</html>